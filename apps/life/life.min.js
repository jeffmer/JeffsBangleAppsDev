Bangle.setLCDTimeout(30);var buf=Graphics.createArrayBuffer(160,160,1,{msb:!0});function flip(){g.drawImage({width:160,height:160,bpp:1,buffer:buf.buffer},40,40);buf.clear()}var genA=new Uint8Array(324),genB=new Uint8Array(324),generation=0,start=Date.now(),currentY=1;function initDraw(a){for(var d=1;17>d;++d)for(var e=1;17>e;++e){var c=.5>Math.random()?1:0;a[e+18*d]=c;if(1==c){c=10*(e-1);var b=10*(d-1);buf.fillRect(c,b,c+7,b+7)}}flip()}
function howlong(){var a=Date.now(),d=Math.floor(a-start);start=a;g.setColor(1,1,1);++generation;g.setFont("6x8",2);g.setFontAlign(-1,-1,0);g.drawString("Gen:"+generation+"  "+d+"ms  ",20,220,!0)}
function next(){"ram";for(var a=genA,d=genB,e=currentY,c=1;17>c;++c){var b=c+18*e,f=a[b-19]+a[b-18]+a[b-17]+a[b-1]+a[b+1]+a[b+17]+a[b+18]+a[b+19];f=1==a[b]&&2==f||3==f?1:0;d[b]=f;1==f&&(b=10*(c-1),f=10*(e-1),buf.fillRect(b,f,b+7,f+7))}16==e?(flip(),a=genA,genA=genB,genB=a,howlong(),currentY=1):++currentY}function reset(){g.setColor(1,1,1);initDraw(genA);currentY=1;generation=0}var intervalRef=null;function stopdraw(){intervalRef&&clearInterval(intervalRef)}
function startdraw(){g.clear();Bangle.drawWidgets();g.reset();g.setColor(1,1,1);g.setFont("6x8",2);g.setFontAlign(0,0,3);g.drawString("Reset",230,200);intervalRef=setInterval(next,60)}function setButtons(){setWatch(Bangle.showLauncher,BTN2,{repeat:!1,edge:"falling"});setWatch(reset,BTN3,{repeat:!0,edge:"rising"})}var SCREENACCESS={withApp:!0,request:function(){this.withApp=!1;stopdraw();clearWatch()},release:function(){this.withApp=!0;startdraw();setButtons()}};
Bangle.on("lcdPower",function(a){SCREENACCESS.withApp&&(a?startdraw():stopdraw())});g.clear();Bangle.loadWidgets();startdraw();setButtons();reset();
